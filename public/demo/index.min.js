!function(t,e,n){"use strict";function i(t,e,n,i){var r,o=0;return e<n?(r=e,o=0):(r=n,o=1),i<r&&(o=2),k[t][o]}function r(t,e,n,o,s,a,l,c,u){var h,d,p,f,y=t.children;if(s>=0&&a>=0&&l>=0)if(null===y)u.push(t);else{h=function(t,e,n,i,r,o){var s=0;return t>e&&t>n?(r<t&&(s|=2),o<t&&(s|=1)):e>n?(i<e&&(s|=4),o<e&&(s|=1)):(i<n&&(s|=4),r<n&&(s|=2)),s}(e,n,o,d=.5*(e+s),p=.5*(n+a),f=.5*(o+l));do{switch(h){case 0:r(y[j],e,n,o,d,p,f,c,u),h=i(h,d,p,f);break;case 1:r(y[1^j],e,n,f,d,p,l,c,u),h=i(h,d,p,l);break;case 2:r(y[2^j],e,p,o,d,a,f,c,u),h=i(h,d,a,f);break;case 3:r(y[3^j],e,p,f,d,a,l,c,u),h=i(h,d,a,l);break;case 4:r(y[4^j],d,n,o,s,p,f,c,u),h=i(h,s,p,f);break;case 5:r(y[5^j],d,n,f,s,p,l,c,u),h=i(h,s,p,l);break;case 6:r(y[6^j],d,p,o,s,a,f,c,u),h=i(h,s,a,f);break;case 7:r(y[7^j],d,p,f,s,a,l,c,u),h=8}}while(h<8)}}function o(t){var e,n,i,r=t.children,s=0;if(null!==r)for(e=0,n=r.length;e<n;++e)(i=1+o(r[e]))>s&&(s=i);return s}function s(t,e,n){var i,r,o=t.children;if(B.min=t.min,B.max=t.max,e.intersectsBox(B))if(null!==o)for(i=0,r=o.length;i<r;++i)s(o[i],e,n);else n.push(t)}function a(t,e,n,i){var r,o,s=t.children;if(n===e)i.push(t);else if(null!==s)for(++n,r=0,o=s.length;r<o;++r)a(s[r],e,n,i)}function l(t){var e,n,i=t.children,r=0;if(null!==i)for(e=0,n=i.length;e<n;++e)r+=l(i[e]);else null!==t.points&&(r=t.points.length);return r}function c(t,e,n,i,r){var o,s,a=i.children,l=!1,u=!1;if(i.contains(t,n.bias)){if(null===a){if(null===i.points)i.points=[],i.data=[];else for(o=0,s=i.points.length;!l&&o<s;++o)l=i.points[o].equals(t);l?(i.data[o-1]=e,u=!0):i.points.length<n.maxPoints||r===n.maxDepth?(i.points.push(t.clone()),i.data.push(e),++n.pointCount,u=!0):(i.split(),i.redistribute(n.bias),a=i.children)}if(null!==a)for(++r,o=0,s=a.length;!u&&o<s;++o)u=c(t,e,n,a[o],r)}return u}function u(t,e,n,i){var r,o,s,a,c,h=n.children,d=null;if(n.contains(t,e.bias))if(null!==h)for(r=0,o=h.length;null===d&&r<o;++r)d=u(t,e,h[r],n);else if(null!==n.points)for(s=n.points,a=n.data,r=0,o=s.length;r<o;++r)if(s[r].equals(t)){c=o-1,d=a[r],r<c&&(s[r]=s[c],a[r]=a[c]),s.pop(),a.pop(),--e.pointCount,null!==i&&l(i)<=e.maxPoints&&i.merge();break}return d}function h(t,e,n){var i,r,o,s=n.children,a=null;if(n.contains(t,e.bias))if(null!==s)for(i=0,r=s.length;null===a&&i<r;++i)a=h(t,e,s[i]);else for(i=0,r=(o=n.points).length;null===a&&i<r;++i)t.distanceToSquared(o[i])<=D&&(a=n.data[i]);return a}function d(t,e,n,i,r,o){var s,a,l,h=i.children,p=null;if(i.contains(t,n.bias))if(i.contains(e,n.bias)){if(null!==h)for(++o,s=0,a=h.length;null===p&&s<a;++s)p=d(t,e,n,h[s],i,o);else for(s=0,a=(l=i.points).length;s<a;++s)if(t.distanceToSquared(l[s])<=D){l[s].copy(e),p=i.data[s];break}}else c(e,p=u(t,n,i,r),n,r,o-1);return p}function p(t,e,n,i){var r,o,s,a,l,c,u,h=i.points,d=i.children,f=null,y=e;if(null!==d)for(r=0,o=(l=d.map(function(e){return{octant:e,distance:e.distanceToCenterSquared(t)}}).sort(function(t,e){return t.distance-e.distance})).length;r<o;++r)(c=l[r].octant).contains(t,y)&&null!==(u=p(t,y,n,c))&&(a=u.point.distanceToSquared(t),(!n||a>0)&&a<y&&(y=a,f=u));else if(null!==h)for(r=0,o=h.length;r<o;++r)s=h[r],a=t.distanceToSquared(s),(!n||a>0)&&a<y&&(y=a,f={point:s.clone(),data:i.data[r]});return f}function f(t,e,n,i,r){var o,s,a,l,c,u=i.points,h=i.children,d=e*e;if(null!==h)for(o=0,s=h.length;o<s;++o)(c=h[o]).contains(t,e)&&f(t,e,n,c,r);else if(null!==u)for(o=0,s=u.length;o<s;++o)a=u[o],l=t.distanceToSquared(a),(!n||l>0)&&l<=d&&r.push({point:a.clone(),data:i.data[o]})}e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n;var y=function(e){function n(t){void 0===t&&(t=null),e.call(this),this.name="OctreeHelper",this.octree=t,this.update()}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.createLineSegments=function(n,i){var r,o,s,a,l,c,u,h,d,p,f,y,v,g,x,b,A=Math.pow(2,16)/8-1,z=new e,C=new t.LineBasicMaterial({color:16777215*Math.random()});for(p=0,s=0,g=Math.ceil(i/A);g>0;--g){for(s+=i<A?i:A,i-=A,o=8*s,a=new Uint16Array(3*o),l=new Float32Array(3*o),y=0,v=0,r=n.next();!r.done&&p<s;){for(u=(c=r.value).min,h=c.max,f=0;f<12;++f)b=w[f],a[v++]=y+b[0],a[v++]=y+b[1];for(f=0;f<8;++f,++y)x=m[f],l[3*y]=0===x[0]?u.x:h.x,l[3*y+1]=0===x[1]?u.y:h.y,l[3*y+2]=0===x[2]?u.z:h.z;++p<s&&(r=n.next())}(d=new t.BufferGeometry).setIndex(new t.BufferAttribute(a,1)),d.addAttribute("position",new t.BufferAttribute(l,3)),z.add(new t.LineSegments(d,C))}this.add(z)},n.prototype.update=function(){var t,e=null!==this.octree?this.octree.getDepth():-1,n=0;for(this.dispose();n<=e;)t=this.octree.findOctantsByLevel(n),this.createLineSegments(t[Symbol.iterator](),"number"==typeof t.size?t.size:t.length),++n},n.prototype.dispose=function(){var t,e,n,i,r,o,s=this.children;for(n=0,r=s.length;n<r;++n){for(i=0,o=(e=(t=s[n]).children).length;i<o;++i)e[i].geometry.dispose(),e[i].material.dispose();for(;e.length>0;)t.remove(e[0])}for(;s.length>0;)this.remove(s[0])},n}(t.Group),m=[new Uint8Array([0,0,0]),new Uint8Array([0,0,1]),new Uint8Array([0,1,0]),new Uint8Array([0,1,1]),new Uint8Array([1,0,0]),new Uint8Array([1,0,1]),new Uint8Array([1,1,0]),new Uint8Array([1,1,1])],w=[new Uint8Array([0,4]),new Uint8Array([1,5]),new Uint8Array([2,6]),new Uint8Array([3,7]),new Uint8Array([0,2]),new Uint8Array([1,3]),new Uint8Array([4,6]),new Uint8Array([5,7]),new Uint8Array([0,1]),new Uint8Array([2,3]),new Uint8Array([4,5]),new Uint8Array([6,7])],v=new t.Vector3,g=function(e,n){void 0===e&&(e=new t.Vector3),void 0===n&&(n=new t.Vector3),this.min=e,this.max=n,this.children=null};g.prototype.getCenter=function(e){return void 0===e&&(e=new t.Vector3),e.addVectors(this.min,this.max).multiplyScalar(.5)},g.prototype.getDimensions=function(e){return void 0===e&&(e=new t.Vector3),e.subVectors(this.max,this.min)},g.prototype.split=function(){var e,n,i=this.min,r=this.max,o=this.getCenter(v),s=this.children=[null,null,null,null,null,null,null,null];for(e=0;e<8;++e)n=x[e],s[e]=new this.constructor(new t.Vector3(0===n[0]?i.x:o.x,0===n[1]?i.y:o.y,0===n[2]?i.z:o.z),new t.Vector3(0===n[0]?o.x:r.x,0===n[1]?o.y:r.y,0===n[2]?o.z:r.z))};var x=[new Uint8Array([0,0,0]),new Uint8Array([0,0,1]),new Uint8Array([0,1,0]),new Uint8Array([0,1,1]),new Uint8Array([1,0,0]),new Uint8Array([1,0,1]),new Uint8Array([1,1,0]),new Uint8Array([1,1,1])],b=new t.Vector3,A=function(e,n){void 0===e&&(e=new t.Vector3),void 0===n&&(n=0),this.min=e,this.size=n,this.children=null},z={max:{configurable:!0}};z.max.get=function(){return this.min.clone().addScalar(this.size)},A.prototype.getCenter=function(e){return void 0===e&&(e=new t.Vector3),e.copy(this.min).addScalar(.5*this.size)},A.prototype.getDimensions=function(e){return void 0===e&&(e=new t.Vector3),e.set(this.size,this.size,this.size)},A.prototype.split=function(){var e,n,i=this.min,r=this.getCenter(b),o=.5*this.size,s=this.children=[null,null,null,null,null,null,null,null];for(e=0;e<8;++e)n=x[e],s[e]=new this.constructor(new t.Vector3(0===n[0]?i.x:r.x,0===n[1]?i.y:r.y,0===n[2]?i.z:r.z),o)},Object.defineProperties(A.prototype,z);var C=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1),this.value=t,this.done=e};C.prototype.reset=function(){this.value=null,this.done=!1};var P=new t.Box3,U=function(t,e){void 0===e&&(e=null),this.octree=t,this.region=e,this.cull=null!==e,this.result=new C,this.trace=null,this.indices=null,this.reset()};U.prototype.reset=function(){var t=this.octree.root;return this.trace=[],this.indices=[],null!==t&&(P.min=t.min,P.max=t.max,this.cull&&!this.region.intersectsBox(P)||(this.trace.push(t),this.indices.push(0))),this.result.reset(),this},U.prototype.next=function(){for(var t,e,n,i=this.cull,r=this.region,o=this.indices,s=this.trace,a=null,l=s.length-1;null===a&&l>=0;)if(t=o[l],e=s[l].children,++o[l],t<8)if(null!==e){if(n=e[t],i&&(P.min=n.min,P.max=n.max,!r.intersectsBox(P)))continue;s.push(n),o.push(0),++l}else a=s.pop(),o.pop();else s.pop(),o.pop(),--l;return this.result.value=a,this.result.done=null===a,this.result},U.prototype.return=function(t){return this.result.value=t,this.result.done=!0,this.result},U.prototype[Symbol.iterator]=function(){return this};var M=[new t.Vector3,new t.Vector3,new t.Vector3],O=new t.Box3,S=new t.Ray,k=[new Uint8Array([4,2,1]),new Uint8Array([5,3,8]),new Uint8Array([6,8,3]),new Uint8Array([7,8,8]),new Uint8Array([8,6,5]),new Uint8Array([8,7,8]),new Uint8Array([8,8,7]),new Uint8Array([8,8,8])],j=0,V=function(){};V.intersectOctree=function(t,e,n){var i,o,s,a,l,c,u,h,d,p=O.min.set(0,0,0),f=O.max.subVectors(t.max,t.min),y=t.getDimensions(M[0]),m=M[1].copy(y).multiplyScalar(.5),w=S.origin.copy(e.ray.origin),v=S.direction.copy(e.ray.direction);w.sub(t.getCenter(M[2])).add(m),j=0,v.x<0&&(w.x=y.x-w.x,v.x=-v.x,j|=4),v.y<0&&(w.y=y.y-w.y,v.y=-v.y,j|=2),v.z<0&&(w.z=y.z-w.z,v.z=-v.z,j|=1),i=1/v.x,o=1/v.y,s=1/v.z,a=(p.x-w.x)*i,l=(f.x-w.x)*i,c=(p.y-w.y)*o,u=(f.y-w.y)*o,h=(p.z-w.z)*s,d=(f.z-w.z)*s,Math.max(Math.max(a,c),h)<Math.min(Math.min(l,u),d)&&r(t.root,a,c,h,l,u,d,e,n)};var B=new t.Box3,F=function(t,e){this.root=void 0!==t&&void 0!==e?new g(t,e):null},H={min:{configurable:!0},max:{configurable:!0},children:{configurable:!0}};H.min.get=function(){return this.root.min},H.max.get=function(){return this.root.max},H.children.get=function(){return this.root.children},F.prototype.getCenter=function(t){return this.root.getCenter(t)},F.prototype.getDimensions=function(t){return this.root.getDimensions(t)},F.prototype.getDepth=function(){return o(this.root)},F.prototype.cull=function(t){var e=[];return s(this.root,t,e),e},F.prototype.findOctantsByLevel=function(t){var e=[];return a(this.root,t,0,e),e},F.prototype.raycast=function(t,e){return void 0===e&&(e=[]),V.intersectOctree(this,t,e),e},F.prototype.leaves=function(t){return new U(this,t)},F.prototype[Symbol.iterator]=function(){return new U(this)},Object.defineProperties(F.prototype,H);var _=new t.Vector3,E=function(t){function e(e,n){t.call(this,e,n),this.points=null,this.data=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.distanceToSquared=function(t){return _.copy(t).clamp(this.min,this.max).sub(t).lengthSq()},e.prototype.distanceToCenterSquared=function(t){var e=this.getCenter(_),n=t.x-e.x,i=t.y-e.x,r=t.z-e.z;return n*n+i*i+r*r},e.prototype.contains=function(t,e){var n=this.min,i=this.max;return t.x>=n.x-e&&t.y>=n.y-e&&t.z>=n.z-e&&t.x<=i.x+e&&t.y<=i.y+e&&t.z<=i.z+e},e.prototype.redistribute=function(t){var e,n,i,r,o,s,a,l=this.children,c=this.points,u=this.data;if(null!==l)for(e=0,i=c.length;e<i;++e)for(s=c[e],a=u[e],n=0,r=l.length;n<r;++n)if((o=l[n]).contains(s,t)){null===o.points&&(o.points=[],o.data=[]),o.points.push(s),o.data.push(a);break}this.points=null,this.data=null},e.prototype.merge=function(){var t,e,n,i=this.children;if(null!==i){for(this.points=[],this.data=[],t=0,e=i.length;t<e;++t)null!==(n=i[t]).points&&((r=this.points).push.apply(r,n.points),(o=this.data).push.apply(o,n.data));this.children=null}var r,o},e}(g),q=function(t,e,n,i){void 0===i&&(i=null),this.distance=t,this.distanceToRay=e,this.point=n,this.object=i},D=1e-6,T=function(t){function e(e,n,i,r,o){void 0===i&&(i=0),void 0===r&&(r=8),void 0===o&&(o=8),t.call(this),this.root=new E(e,n),this.bias=Math.max(0,i),this.maxPoints=Math.max(1,Math.round(r)),this.maxDepth=Math.max(0,Math.round(o)),this.pointCount=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.countPoints=function(t){return l(t)},e.prototype.put=function(t,e){return c(t,e,this,this.root,0)},e.prototype.remove=function(t){return u(t,this,this.root,null)},e.prototype.fetch=function(t){return h(t,this,this.root)},e.prototype.move=function(t,e){return d(t,e,this,this.root,null,0)},e.prototype.findNearestPoint=function(t,e,n){return void 0===e&&(e=1/0),void 0===n&&(n=!1),p(t,e,n,this.root)},e.prototype.findPoints=function(t,e,n){void 0===n&&(n=!1);var i=[];return f(t,e,n,this.root,i),i},e.prototype.raycast=function(e,n){void 0===n&&(n=[]);var i=t.prototype.raycast.call(this,e);return i.length>0&&this.testPoints(i,e,n),n},e.prototype.testPoints=function(t,e,n){var i,r,o,s,a,l,c,u,h,d,p,f=e.params.Points.threshold,y=f*f;for(a=0,c=t.length;a<c;++a)if(h=t[a],null!==(d=h.points))for(l=0,u=d.length;l<u;++l)p=d[l],(s=e.ray.distanceSqToPoint(p))<y&&(i=e.ray.closestPointToPoint(p),(r=e.ray.origin.distanceTo(i))>=e.near&&r<=e.far&&(o=Math.sqrt(s),n.push(new q(r,o,i,h.data[l]))))},e}(F),L=(new t.Box3,new t.Vector3,new t.Vector3,new t.Vector3,function(e){this.renderer=e,this.loadingManager=new t.LoadingManager,this.assets=null,this.scene=new t.Scene,this.scene.fog=new t.FogExp2(855309,.0025),this.camera=new t.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.1,2e3),this.controls=null});L.prototype.load=function(t){t()},L.prototype.initialise=function(){},L.prototype.render=function(t){},L.prototype.configure=function(t){},L.prototype.reset=function(){var e=this.scene.fog;return this.scene=new t.Scene,this.scene.fog=e,null!==this.controls&&(this.controls.dispose(),this.controls=null),this};var I=new t.Vector2,R=function(e){function n(n,i,r){e.call(this),this.params.Points.threshold=.1,this.octree=n,this.camera=i,this.object=r,this.enabled=!0,this.delta="",this.selectedObject=null,this.selectedPoint=new t.Mesh(new t.SphereBufferGeometry(.2,16,16),new t.MeshBasicMaterial({transparent:!0,color:52479,opacity:.75})),this.selectedPoint.visible=!1}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.handleEvent=function(t){switch(t.type){case"mousemove":this.raycast(t)}},n.prototype.raycast=function(t){var e,n,i,r;I.x=t.clientX/window.innerWidth*2-1,I.y=-t.clientY/window.innerHeight*2+1,this.setFromCamera(I,this.camera),this.enabled?(n=performance.now(),e=this.octree.raycast(this),i=performance.now()):(n=performance.now(),e=this.intersectObjects(this.object.children),i=performance.now()),this.delta=(i-n).toFixed(2)+" ms",null!==this.selectedObject&&(this.selectedObject.material.color.setHex(12582912),this.selectedObject=null,this.selectedPoint.visible=!1),e.length>0&&(void 0!==(r=e[0]).object?(this.selectedObject=r.object,this.selectedObject.material.color.setHex(13434624),this.selectedPoint.visible=r.object.parent.visible,this.selectedPoint.position.copy(r.point)):console.warn(e))},n.prototype.configure=function(t){var e=t.addFolder("Raycasting");e.add(this,"enabled"),e.add(this,"delta").listen(),e.open()},n}(t.Raycaster),G=new t.Matrix4,W=new t.Frustum,N=function(e,n){this.octree=e,this.scene=n,this.enabled=!1,this.cullCamera=new t.PerspectiveCamera(20,1.77,.5,5),this.cullCamera.matrixAutoUpdate=!1,this.s=new t.Spherical(5,Math.PI/3,1.75*Math.PI),this.delta="",this.culledOctants=new t.Points(new t.BufferGeometry,new t.PointsMaterial({color:13434624,sizeAttenuation:!1,size:2})),this.culledOctants.visible=!1,this.cameraHelper=new t.CameraHelper(this.cullCamera),this.cameraHelper.visible=!1};N.prototype.updateCamera=function(){var t=this.cullCamera;t.position.setFromSpherical(this.s),t.lookAt(this.scene.position),t.updateMatrix(),t.updateMatrixWorld(),W.setFromMatrix(G.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse))},N.prototype.cull=function(){var e,n,i,r,o,s,a,l=this.culledOctants;if(this.enabled){if(this.updateCamera(),e=performance.now(),s=this.octree.cull(W),this.delta=(performance.now()-e).toFixed(2)+" ms",s.length>0){for(a=new Float32Array(3*s.length*2),n=0,i=0,r=s.length;n<r;++n)o=s[n],a[i++]=o.min.x,a[i++]=o.min.y,a[i++]=o.min.z,a[i++]=o.max.x,a[i++]=o.max.y,a[i++]=o.max.z;l.geometry.removeAttribute("position"),l.geometry.addAttribute("position",new t.BufferAttribute(a,3)),this.scene.remove(l),this.scene.add(l)}else this.scene.remove(l);this.cameraHelper.update()}},N.prototype.configure=function(t){var e=this,n=t.addFolder("Frustum Culling");n.add(this,"enabled").onChange(function(){e.cameraHelper.visible=e.culledOctants.visible=e.enabled,e.cull()}),n.add(this,"delta").listen(),n.open();var i=n.addFolder("Camera Adjustment");i.add(this.s,"radius").min(.1).max(10).step(.1).onChange(function(){e.cull()}),i.add(this.s,"phi").min(1e-6).max(Math.PI-1e-6).onChange(function(){e.cull()}),i.add(this.s,"theta").min(0).max(2*Math.PI).onChange(function(){e.cull()})};var K=function(e){function n(t){e.call(this,t),this.points=null,this.octreeHelper=null,this.octreeRaycaster=null,this.frustumCuller=null}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.initialise=function(){var e=this.scene,n=this.camera,i=this.renderer;e.fog=new t.FogExp2(855309,.025),this.controls=new t.OrbitControls(n,i.domElement),this.controls.maxDistance=60,n.near=.1,n.far=200,n.position.set(10,6,10),n.lookAt(this.controls.target);var r=function(){function e(e,n,i,r){var o,s,a,l,c,u=new t.BufferGeometry,h=new Float32Array(3*e),d=n/2;for(l=0,c=h.length;l<c;l+=3)o=Math.random()*n-d,s=Math.random()*n-d,a=i+(Math.random()*r*2-r),h[l]=o,h[l+1]=s,h[l+2]=a;return u.addAttribute("position",new t.BufferAttribute(h,3)),u}var n,i=new t.Object3D,r=8,o=6/(r-1),s=-3,a=new t.PointsMaterial({color:12582912,sizeAttenuation:!1,size:1});for(console.log("Generating",65536*r,"points...");r-- >0;)n=new t.Points(e(65536,6,s,.25),a),a=a.clone(),s+=o,i.add(n);return i}();this.points=r,e.add(r);var o=function(n){var i=new t.Vector3,r=new t.Box3;r.setFromObject(e);var o,s,a,l,c,u=performance.now(),h=new T(r.min,r.max,0,8,5);for(o=n.children.length-1;o>=0;--o)for(a=0,l=(c=(s=n.children[o]).geometry.getAttribute("position").array).length;a<l;a+=3)h.put(i.fromArray(c,a),s);return console.log("Octree:",h,"created in",(performance.now()-u).toFixed(2)+" ms"),h}(r),s=function(t){var e=performance.now(),n=new y(t);return n.visible=!1,console.log("OctreeHelper:",n,"created in",(performance.now()-e).toFixed(2)+" ms"),n}(o);this.octreeHelper=s,e.add(s),this.raycaster=new R(o,n,r),i.domElement.parentNode.addEventListener("mousemove",this.raycaster),e.add(this.raycaster.selectedPoint),this.frustumCuller=new N(o,e),e.add(this.frustumCuller.cameraHelper)},n.prototype.render=function(t){this.renderer.render(this.scene,this.camera)},n.prototype.configure=function(t){var e=this.points,n=this.octreeHelper;this.raycaster.configure(t),this.frustumCuller.configure(t);var i={"level mask":n.children.length},r=t.addFolder("Points");r.add(e,"visible"),r.open(),(r=t.addFolder("Octree Helper")).add(n,"visible"),r.add(i,"level mask").min(0).max(n.children.length).step(1).onChange(function(){var t,e;for(t=0,e=n.children.length;t<e;++t)n.children[t].visible=i["level mask"]===n.children.length||t===i["level mask"]}),r.open()},n}(L),X=function(){this.clock=new t.Clock,this.renderer=new t.WebGLRenderer({logarithmicDepthBuffer:!0,antialias:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(0),this.renderer.setPixelRatio(window.devicePixelRatio),this.stats=function(){var t=new n;return t.showPanel(0),t.dom.id="stats",t}(),this.demos=function(t){var e=new Map;return e.set("point-octree",new K(t)),e}(this.renderer),this.key=function(t){var e=window.location.hash.slice(1);return 0!==e.length&&t.has(e)||(e=t.keys().next().value),e}(this.demos)};X.prototype.initialise=function(t,n,i){function r(){h.initialise(),h.camera.aspect=window.innerWidth/window.innerHeight,h.camera.updateProjectionMatrix(),(d=new e.GUI({autoPlace:!1})).add(s,"key",Array.from(u.keys())).onChange(o),h.configure(d),n.appendChild(d.domElement),i.style.display="none",a.domElement.style.visibility="visible"}function o(){var t=a.getSize();i.style.display="block",a.domElement.style.visibility="hidden",null!==d&&(d.destroy(),n.removeChild(d.domElement)),null!==h&&(h.reset(),a.setSize(t.width,t.height)),(h=u.get(s.key)).load(r),window.location.hash=s.key}var s=this,a=this.renderer,l=this.clock,c=this.stats,u=this.demos,h=null,d=null;t.appendChild(a.domElement),n.appendChild(c.dom),o(),document.addEventListener("keydown",function(t){t.altKey&&(t.preventDefault(),n.style.visibility="hidden"===n.style.visibility?"visible":"hidden")}),window.addEventListener("resize",function(){function t(t){var n=t.target.innerWidth,i=t.target.innerHeight;a.setSize(n,i),h.camera.aspect=n/i,h.camera.updateProjectionMatrix(),e=0}var e=0;return function(n){0===e&&(e=setTimeout(t,66,n))}}()),function t(e){var n=l.getDelta();requestAnimationFrame(t),c.begin(),h.render(n),c.end()}()},window.addEventListener("load",function t(e){var n=document.getElementById("viewport"),i=n.children[0],r=document.getElementById("aside"),o=new X;window.removeEventListener("load",t),r.style.visibility="visible",o.initialise(n,r,i)})}(THREE,dat,Stats);